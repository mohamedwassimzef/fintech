<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="tn.esprit.services.AIAnalysisController"
            prefWidth="1200" prefHeight="700"
            style="-fx-background-color: #0f172a;">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- SIDEBAR GAUCHE -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <left>
        <VBox prefWidth="300" spacing="0"
              style="-fx-background-color: #1e293b;">

            <!-- En-tÃªte sidebar -->
            <VBox alignment="CENTER" spacing="8"
                  style="-fx-padding: 30 20 25 20; -fx-background-color: #0f172a;">
                <Label text="ðŸ¤–"
                       style="-fx-font-size: 36px;"/>
                <Label text="Assistant IA"
                       style="-fx-text-fill: #f59e0b; -fx-font-size: 18px; -fx-font-weight: bold;"/>
                <Label text="Analyse Claude AI"
                       style="-fx-text-fill: #475569; -fx-font-size: 11px;"/>
                <Label fx:id="labelUser"
                       style="-fx-text-fill: #94a3b8; -fx-font-size: 12px;"/>
            </VBox>

            <Separator style="-fx-background-color: #334155;"/>

            <!-- KPIs -->
            <VBox spacing="0" style="-fx-padding: 20 16;">
                <Label text="ðŸ“Š RÃ©sumÃ©"
                       style="-fx-text-fill: #64748b; -fx-font-size: 11px; -fx-font-weight: bold;
                              -fx-padding: 0 0 12 0;"/>

                <!-- Nb transactions -->
                <VBox spacing="3"
                      style="-fx-background-color: #0f172a; -fx-background-radius: 10;
                             -fx-padding: 14; -fx-margin: 0 0 10 0;">
                    <Label text="ðŸ“‹ Transactions analysÃ©es"
                           style="-fx-text-fill: #64748b; -fx-font-size: 11px;"/>
                    <Label fx:id="labelTxCount"
                           text="â€”"
                           style="-fx-text-fill: white; -fx-font-size: 22px; -fx-font-weight: bold;"/>
                </VBox>

                <VBox spacing="10" style="-fx-padding: 8 0 0 0;">
                    <!-- DÃ©bits -->
                    <VBox spacing="3"
                          style="-fx-background-color: #3f1515; -fx-background-radius: 10; -fx-padding: 12;">
                        <Label text="ðŸ’³ Total DÃ©bits"
                               style="-fx-text-fill: #94a3b8; -fx-font-size: 11px;"/>
                        <Label fx:id="labelTotalDebit"
                               text="â€”"
                               style="-fx-text-fill: #ef4444; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    </VBox>

                    <!-- CrÃ©dits -->
                    <VBox spacing="3"
                          style="-fx-background-color: #063f20; -fx-background-radius: 10; -fx-padding: 12;">
                        <Label text="ðŸ’° Total CrÃ©dits"
                               style="-fx-text-fill: #94a3b8; -fx-font-size: 11px;"/>
                        <Label fx:id="labelTotalCredit"
                               text="â€”"
                               style="-fx-text-fill: #22c55e; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    </VBox>

                    <!-- Solde -->
                    <VBox spacing="3"
                          style="-fx-background-color: #1e293b; -fx-background-radius: 10;
                                 -fx-padding: 12; -fx-border-color: #334155;
                                 -fx-border-radius: 10; -fx-border-width: 1;">
                        <Label text="âš–ï¸ Solde Net"
                               style="-fx-text-fill: #94a3b8; -fx-font-size: 11px;"/>
                        <Label fx:id="labelBalance"
                               text="â€”"
                               style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    </VBox>
                </VBox>
            </VBox>

            <Separator style="-fx-background-color: #334155;"/>

            <!-- Options -->
            <VBox spacing="10" style="-fx-padding: 16;">
                <Label text="âš™ï¸ Options"
                       style="-fx-text-fill: #64748b; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                <Label text="PÃ©riode Ã  analyser :"
                       style="-fx-text-fill: #94a3b8; -fx-font-size: 12px;"/>
                <ComboBox fx:id="periodFilter" maxWidth="Infinity" prefHeight="36"
                          style="-fx-background-color: #0f172a; -fx-text-fill: white;
                                 -fx-border-color: #334155; -fx-border-radius: 8;
                                 -fx-background-radius: 8;"/>
            </VBox>

            <!-- Spacer -->
            <Region VBox.vgrow="ALWAYS"/>

            <!-- Navigation -->
            <VBox spacing="8" style="-fx-padding: 16;">
                <Button fx:id="btnTransactions"
                        text="ðŸ’¸ Mes Transactions"
                        onAction="#navigateToTransactions"
                        maxWidth="Infinity" prefHeight="38"
                        style="-fx-background-color: #334155; -fx-text-fill: white;
                               -fx-background-radius: 8; -fx-cursor: hand;
                               -fx-font-weight: bold;"/>
            </VBox>
        </VBox>
    </left>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- CONTENU PRINCIPAL -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <center>
        <VBox spacing="0">

            <!-- En-tÃªte principal -->
            <HBox alignment="CENTER_LEFT" spacing="20"
                  style="-fx-background-color: #1e293b; -fx-padding: 20 30;">
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="ðŸ¤– Analyse IA de vos Transactions"
                           style="-fx-text-fill: white; -fx-font-size: 20px; -fx-font-weight: bold;"/>
                    <Label text="Claude AI analyse vos habitudes financiÃ¨res et vous donne des conseils personnalisÃ©s"
                           style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                </VBox>

                <Button fx:id="btnAnalyze"
                        text="ðŸ¤– Analyser avec Claude AI"
                        onAction="#analyzeWithAI"
                        prefHeight="46" prefWidth="240"
                        style="-fx-background-color: #f59e0b; -fx-text-fill: #0f172a;
                               -fx-background-radius: 10; -fx-font-size: 14px;
                               -fx-font-weight: bold; -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(245,158,11,0.4), 15, 0, 0, 3);"/>
            </HBox>

            <!-- Chargement -->
            <VBox fx:id="loadingBox" alignment="CENTER" spacing="15"
                  style="-fx-background-color: #0f172a; -fx-padding: 30;">
                <ProgressIndicator fx:id="progressIndicator"
                                   prefWidth="50" prefHeight="50"
                                   style="-fx-accent: #f59e0b;"/>
                <Label fx:id="labelLoading"
                       text="ðŸ¤– Claude analyse vos transactions..."
                       style="-fx-text-fill: #f59e0b; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                <Label text="Cela peut prendre 5 Ã  15 secondes selon le nombre de transactions."
                       style="-fx-text-fill: #475569; -fx-font-size: 11px;"/>
            </VBox>

            <!-- Zone d'analyse (rÃ©sultat) -->
            <VBox VBox.vgrow="ALWAYS"
                  style="-fx-background-color: #0f172a; -fx-padding: 20 30;">

                <Label text="ðŸ“ RÃ©sultat de l'analyse :"
                       style="-fx-text-fill: #64748b; -fx-font-size: 11px;
                              -fx-font-weight: bold; -fx-padding: 0 0 10 0;"/>

                <TextArea fx:id="analysisArea"
                          VBox.vgrow="ALWAYS"
                          editable="false"
                          wrapText="true"
                          promptText="Cliquez sur 'Analyser avec Claude AI' pour obtenir une analyse personnalisÃ©e de vos transactions...&#10;&#10;Claude va :&#10;  ðŸ“Š RÃ©sumer votre situation financiÃ¨re&#10;  ðŸ” Identifier les patterns de dÃ©penses&#10;  ðŸ’¡ Vous donner 3 conseils personnalisÃ©s&#10;  âš ï¸ Signaler les anomalies"
                          style="-fx-background-color: #1e293b;
                                 -fx-text-fill: #e2e8f0;
                                 -fx-border-color: #334155;
                                 -fx-border-radius: 12;
                                 -fx-background-radius: 12;
                                 -fx-padding: 20;
                                 -fx-font-size: 13px;
                                 -fx-font-family: 'Segoe UI';"/>
            </VBox>

            <!-- Note API -->
            <HBox alignment="CENTER"
                  style="-fx-background-color: #1e293b; -fx-padding: 10 30;">
                <Label text="âš¡ PropulsÃ© par Claude gemini-1.5-flash (Google AI Studio) â€” Configurez votre clÃ© API dans ClaudeAIService.java"
                       style="-fx-text-fill: #334155; -fx-font-size: 10px;"/>
            </HBox>
        </VBox>
    </center>

</BorderPane>
